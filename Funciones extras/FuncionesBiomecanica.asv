classdef FuncionesBiomecanica
   methods (Static)
      function [alfa_s, alfa_c, beta_s, beta_c, gamma_s, gamma_c] = AngulosEuler(i,j,k,graficar)
       
         % Se definen I, J, K
         I           = zeros(size(i));
         I(:,1)    = 1;  
         J           = zeros(size(j));
         J(:,2)    = 1;
         K         = zeros(size(k));
         K(:,3)  = 1;
         %--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
         % Calculo de la linea de nodos
         numerador      = cross(K,k);
         denominador  = sqrt(sum(numerador.^2,2));
         nodo                  = numerador./denominador;
        %--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
         % Calculo de los angulos con seno
         alfa_s         = asin(dot(cross(I,nodo),K,2));
         beta_s        = asin(dot(cross(I,nodo),K,2));
         gamma_s  = asin(dot(cross(I,nodo),K,2));
        %--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%         
         % Calculo de los angulos con coseno
         numerador      = dot(J,nodo,2);
         denominador  = sqrt(sum(numerador.^2,2));
         factor                = numerador./denominador;
         alfa_c                = -dot(factor,acos(dot(I,nodo,2)),2);
        %--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%         
         beta_c              = acos(dot(K,k,2));
        %--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%        
         numerador      = dot(j,nodo,2);
         denominador  = sqrt(sum(numerador.^2,2));
         factor                = numerador./denominador;
         gamma_c        = -dot(factor,acos(dot(i,nodo,2)));
         
         if graficar
             figure
             subplot(2,3,1)
             plot(alfa_c
             )
      end

   end
end